



<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta http-equiv="x-dns-prefetch-control" content="on">
      <link rel="dns-prefetch" href="//oi-wiki.org">
      <link rel="dns-prefetch" href="//search.oi-wiki.org">
      <link rel="dns-prefetch" href="//api.github.com">
      <link rel="dns-prefetch" href="//www.google-analytics.com">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="WWeiying's Learn-notes">
      
      
        <link rel="canonical" href="https://www.wweiying.top/math/fibonacci/">
      
      
        <meta name="author" content="WWeiying">
      
      
        <meta name="lang:clipboard.copy" content="复制">
      
        <meta name="lang:clipboard.copied" content="已复制">
      
        <meta name="lang:search.language" content="jp">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="没有找到符合条件的结果">
      
        <meta name="lang:search.result.one" content="找到 1 个符合条件的结果">
      
        <meta name="lang:search.result.other" content="# 个符合条件的结果">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="../../favicon.ico">
      <meta name="generator" content="mkdocs-1.2.4, mkdocs-material-4.4.2">
    
    
      
        <title>Fibonacci - WWeiying's Learn-notes</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.6f7cfa25.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../../assets/javascripts/modernizr.27508f0e.js"></script>
    
    
      
        <style>@font-face{font-family:'Fira Sans';font-style:normal;font-weight:300;src:url(//lib.baomitu.com/fonts/fira-sans/fira-sans-300.eot);src:local('Fira Sans'),local('FiraSans-Normal'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-300.eot?#iefix) format('embedded-opentype'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-300.woff2) format('woff2'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-300.woff) format('woff'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-300.ttf) format('truetype'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-300.svg#FiraSans) format('svg')}@font-face{font-family:'Fira Sans';font-style:normal;font-weight:regular;src:url(//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.eot);src:local('Fira Sans'),local('FiraSans-Normal'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.eot?#iefix) format('embedded-opentype'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.woff2) format('woff2'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.woff) format('woff'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.ttf) format('truetype'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.svg#FiraSans) format('svg')}@font-face{font-family:'Fira Sans';font-style:italic;font-weight:regular;src:url(//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.eot);src:local('Fira Sans'),local('FiraSans-Italic'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.eot?#iefix) format('embedded-opentype'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.woff2) format('woff2'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.woff) format('woff'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.ttf) format('truetype'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.svg#FiraSans) format('svg')}@font-face{font-family:'Fira Sans';font-style:normal;font-weight:700;src:url(//lib.baomitu.com/fonts/fira-sans/fira-sans-700.eot);src:local('Fira Sans'),local('FiraSans-Normal'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-700.eot?#iefix) format('embedded-opentype'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-700.woff2) format('woff2'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-700.woff) format('woff'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-700.ttf) format('truetype'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-700.svg#FiraSans) format('svg')}@font-face{font-family:'Fira Mono';font-style:normal;font-weight:regular;src:url(//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.eot);src:local('Fira Mono'),local('FiraMono-Normal'),url(//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.eot?#iefix) format('embedded-opentype'),url(//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.woff2) format('woff2'),url(//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.woff) format('woff'),url(//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.ttf) format('truetype'),url(//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.svg#FiraMono) format('svg')}body,input{font-family:"Fira Sans","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Fira Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/vendor/material-icons/iconfont/material-icons.css">
    
      <link rel="manifest" href="../../manifest.webmanifest">
    
    
      <link rel="stylesheet" href="../../_static/css/extra.css?v=13">
    
    
      
        
<script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-124485594-1", "auto")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="white" data-md-color-accent="red">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#_1" tabindex="1" class="md-skip">
        跳转至
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://www.wweiying.top/" title="WWeiying's Learn-notes" class="md-header-nav__button md-logo">
          
            <i class="md-icon">school</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              WWeiying's Learn-notes
            </span>
            <span class="md-header-nav__topic">
              
                Fibonacci
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            键入以开始搜索
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/WWeiying/Learn-notes/" title="前往 Github 仓库" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    WWeiying/Learn-notes
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

<nav class="md-tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." class="md-tabs__link">
          简介
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://www.wweiying.top/" title="WWeiying's Learn-notes" class="md-nav__button md-logo">
      
        <i class="md-icon">school</i>
      
    </a>
    WWeiying's Learn-notes
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/WWeiying/Learn-notes/" title="前往 Github 仓库" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    WWeiying/Learn-notes
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      简介
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        简介
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../intro/about/" title="关于本项目" class="md-nav__link">
      关于本项目
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../intro/htc/" title="如何参与" class="md-nav__link">
      如何参与
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../intro/format/" title="格式手册" class="md-nav__link">
      格式手册
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../intro/faq/" title="F.A.Q." class="md-nav__link">
      F.A.Q.
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../intro/docker-deploy/" title="用 Docker 部署 OI Wiki" class="md-nav__link">
      用 Docker 部署 OI Wiki
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../intro/mirrors/" title="镜像站列表" class="md-nav__link">
      镜像站列表
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../intro/thanks/" title="致谢" class="md-nav__link">
      致谢
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    卢卡斯数列
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    斐波那契数列通项公式
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    解析解
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    卢卡斯数列通项公式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    矩阵形式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    快速倍增法
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    性质
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    斐波那契数列与卢卡斯数列的关系
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    斐波那契编码
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    模意义下周期性
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    皮萨诺周期
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    习题
  </a>
  
</li>
      
      
      
      
      
        <li class="md-nav__item">
          <a href="#__comments" title="评论" class="md-nav__link md-nav__link--active">
            评论
          </a>
        </li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/WWeiying/Learn-notes/edit/master/docs/math/fibonacci.md" title="编辑此页" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Fibonacci</h1>
                
                <p>斐波那契数列（The Fibonacci sequence，<a href="http://oeis.org/A000045">OEIS A000045</a>）的定义如下：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
F_0 = 0, F_1 = 1, F_n = F_{n-1} + F_{n-2}
</div>
<script type="math/tex; mode=display">
F_0 = 0, F_1 = 1, F_n = F_{n-1} + F_{n-2}
</script>
</div>
<p>该数列的前几项如下：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, ...
</div>
<script type="math/tex; mode=display">
0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, ...
</script>
</div>
<h2 id="_1">卢卡斯数列<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>卢卡斯数列（The Lucas sequence，<a href="http://oeis.org/A000032">OEIS A000032</a>）的定义如下：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
L_0 = 2, L_1 = 1, L_n = L_{n-1} + L_{n-2}
</div>
<script type="math/tex; mode=display">
L_0 = 2, L_1 = 1, L_n = L_{n-1} + L_{n-2}
</script>
</div>
<p>该数列的前几项如下：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
2, 1, 3, 4, 7, 11, 18, 29, 47, 76, 123, 199, ...
</div>
<script type="math/tex; mode=display">
2, 1, 3, 4, 7, 11, 18, 29, 47, 76, 123, 199, ...
</script>
</div>
<p>研究斐波那契数列，很多时候需要借助卢卡斯数列为工具。</p>
<h2 id="_2">斐波那契数列通项公式<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>第 <span class="arithmatex"><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> 个斐波那契数可以在 <span class="arithmatex"><span class="MathJax_Preview">\Theta (n)</span><script type="math/tex">\Theta (n)</script></span> 的时间内使用递推公式计算。但我们仍有更快速的方法计算。</p>
<h3 id="_3">解析解<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p>解析解即公式解。我们有斐波那契数列的通项公式（Binet's Formula）：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
F_n = \frac{\left(\frac{1 + \sqrt{5}}{2}\right)^n - \left(\frac{1 - \sqrt{5}}{2}\right)^n}{\sqrt{5}}
</div>
<script type="math/tex; mode=display">
F_n = \frac{\left(\frac{1 + \sqrt{5}}{2}\right)^n - \left(\frac{1 - \sqrt{5}}{2}\right)^n}{\sqrt{5}}
</script>
</div>
<p>这个公式可以很容易地用归纳法证明，当然也可以通过生成函数的概念推导，或者解一个方程得到。</p>
<p>当然你可能发现，这个公式分子的第二项总是小于 <span class="arithmatex"><span class="MathJax_Preview">1</span><script type="math/tex">1</script></span>，并且它以指数级的速度减小。因此我们可以把这个公式写成</p>
<div class="arithmatex">
<div class="MathJax_Preview">
F_n = \left[\frac{\left(\frac{1 + \sqrt{5}}{2}\right)^n}{\sqrt{5}}\right]
</div>
<script type="math/tex; mode=display">
F_n = \left[\frac{\left(\frac{1 + \sqrt{5}}{2}\right)^n}{\sqrt{5}}\right]
</script>
</div>
<p>这里的中括号表示取离它最近的整数。</p>
<p>这两个公式在计算的时侯要求极高的精确度，因此在实践中很少用到。但是请不要忽视！结合模意义下二次剩余和逆元的概念，在 OI 中使用这个公式仍是有用的。</p>
<h3 id="_4">卢卡斯数列通项公式<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<p>我们有卢卡斯数列的通项公式：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
L_n = \left(\frac{1 + \sqrt{5}}{2}\right)^n + \left(\frac{1 - \sqrt{5}}{2}\right)^n
</div>
<script type="math/tex; mode=display">
L_n = \left(\frac{1 + \sqrt{5}}{2}\right)^n + \left(\frac{1 - \sqrt{5}}{2}\right)^n
</script>
</div>
<p>与斐波那契数列非常相似。事实上有：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\frac{L_n + F_n\sqrt{5}}{2} = \left(\frac{1 + \sqrt{5}}{2}\right)^n
</div>
<script type="math/tex; mode=display">
\frac{L_n + F_n\sqrt{5}}{2} = \left(\frac{1 + \sqrt{5}}{2}\right)^n
</script>
</div>
<p>也就是说，<span class="arithmatex"><span class="MathJax_Preview">L_n</span><script type="math/tex">L_n</script></span> 和 <span class="arithmatex"><span class="MathJax_Preview">F_n</span><script type="math/tex">F_n</script></span> 恰好构成 <span class="arithmatex"><span class="MathJax_Preview">\left(\frac{1 + \sqrt{5}}{2}\right)^n</span><script type="math/tex">\left(\frac{1 + \sqrt{5}}{2}\right)^n</script></span> 二项式展开再合并同类项后的分子系数。也就是说，Pell 方程</p>
<div class="arithmatex">
<div class="MathJax_Preview">
x^2-5y^2=-4
</div>
<script type="math/tex; mode=display">
x^2-5y^2=-4
</script>
</div>
<p>的全体解，恰好是</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\frac{x_n + y_n\sqrt{5}}{2} = \frac{L_n + F_n\sqrt{5}}{2}
</div>
<script type="math/tex; mode=display">
\frac{x_n + y_n\sqrt{5}}{2} = \frac{L_n + F_n\sqrt{5}}{2}
</script>
</div>
<p>恰好是卢卡斯数列和斐波那契数列。因此有</p>
<div class="arithmatex">
<div class="MathJax_Preview">
{L_n}^2-5{F_n}^2=-4
</div>
<script type="math/tex; mode=display">
{L_n}^2-5{F_n}^2=-4
</script>
</div>
<h3 id="_5">矩阵形式<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<p>斐波那契数列的递推可以用矩阵乘法的形式表达：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\begin{bmatrix}F_{n-1} &amp; F_{n} \cr\end{bmatrix} = \begin{bmatrix}F_{n-2} &amp; F_{n-1} \cr\end{bmatrix} \cdot \begin{bmatrix}0 &amp; 1 \cr 1 &amp; 1 \cr\end{bmatrix}
</div>
<script type="math/tex; mode=display">
\begin{bmatrix}F_{n-1} & F_{n} \cr\end{bmatrix} = \begin{bmatrix}F_{n-2} & F_{n-1} \cr\end{bmatrix} \cdot \begin{bmatrix}0 & 1 \cr 1 & 1 \cr\end{bmatrix}
</script>
</div>
<p>设 <span class="arithmatex"><span class="MathJax_Preview">P = \begin{bmatrix}0 &amp; 1 \cr 1 &amp; 1 \cr\end{bmatrix}</span><script type="math/tex">P = \begin{bmatrix}0 & 1 \cr 1 & 1 \cr\end{bmatrix}</script></span>，我们得到</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\begin{bmatrix}F_n &amp; F_{n+1} \cr\end{bmatrix} = \begin{bmatrix}F_0 &amp; F_1 \cr\end{bmatrix} \cdot P^n
</div>
<script type="math/tex; mode=display">
\begin{bmatrix}F_n & F_{n+1} \cr\end{bmatrix} = \begin{bmatrix}F_0 & F_1 \cr\end{bmatrix} \cdot P^n
</script>
</div>
<p>于是我们可以用矩阵乘法在 <span class="arithmatex"><span class="MathJax_Preview">\Theta(\log n)</span><script type="math/tex">\Theta(\log n)</script></span> 的时间内计算斐波那契数列。此外，前一节讲述的公式也可通过矩阵对角化的技巧来得到。</p>
<h3 id="_6">快速倍增法<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<p>使用上面的方法我们可以得到以下等式：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\begin{array}{rll}
F_{2k} &amp;= F_k \left( 2F_{k+1} - F_{k} \right)\\
F_{2k+1} &amp;= F_{k+1}^2 + F_{k}^2
\end{array}
</div>
<script type="math/tex; mode=display">
\begin{array}{rll}
F_{2k} &= F_k \left( 2F_{k+1} - F_{k} \right)\\
F_{2k+1} &= F_{k+1}^2 + F_{k}^2
\end{array}
</script>
</div>
<p>于是可以通过这样的方法快速计算两个相邻的斐波那契数（常数比矩乘小）。代码如下，返回值是一个二元组 <span class="arithmatex"><span class="MathJax_Preview">(F_n,F_{n+1})</span><script type="math/tex">(F_n,F_{n+1})</script></span>。</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">fib</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">};</span><span class="w"></span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fib</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">first</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">second</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">first</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">first</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">first</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">second</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">second</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">d</span><span class="p">};</span><span class="w"></span>
<span class="w">  </span><span class="k">else</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">};</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div></td></tr></table></div>
<h2 id="_7">性质<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h2>
<p>斐波那契数列拥有许多有趣的性质，这里列举出一部分简单的性质：</p>
<ol>
<li>卡西尼性质（Cassini's identity）：<span class="arithmatex"><span class="MathJax_Preview">F_{n-1} F_{n+1} - F_n^2 = (-1)^n</span><script type="math/tex">F_{n-1} F_{n+1} - F_n^2 = (-1)^n</script></span>。</li>
<li>附加性质：<span class="arithmatex"><span class="MathJax_Preview">F_{n+k} = F_k F_{n+1} + F_{k-1} F_n</span><script type="math/tex">F_{n+k} = F_k F_{n+1} + F_{k-1} F_n</script></span>。</li>
<li>取上一条性质中 <span class="arithmatex"><span class="MathJax_Preview">k = n</span><script type="math/tex">k = n</script></span>，我们得到 <span class="arithmatex"><span class="MathJax_Preview">F_{2n} = F_n (F_{n+1} + F_{n-1})</span><script type="math/tex">F_{2n} = F_n (F_{n+1} + F_{n-1})</script></span>。</li>
<li>由上一条性质可以归纳证明，<span class="arithmatex"><span class="MathJax_Preview">\forall k\in \mathbb{N},F_n|F_{nk}</span><script type="math/tex">\forall k\in \mathbb{N},F_n|F_{nk}</script></span>。</li>
<li>上述性质可逆，即 <span class="arithmatex"><span class="MathJax_Preview">\forall F_a|F_b,a|b</span><script type="math/tex">\forall F_a|F_b,a|b</script></span>。</li>
<li>GCD 性质：<span class="arithmatex"><span class="MathJax_Preview">(F_m, F_n) = F_{(m, n)}</span><script type="math/tex">(F_m, F_n) = F_{(m, n)}</script></span>。</li>
<li>以斐波那契数列相邻两项作为输入会使欧几里德算法达到最坏复杂度（具体参见 <a href="https://en.wikipedia.org/wiki/Gabriel_Lam%C3%A9">维基 - 拉梅</a>）。</li>
</ol>
<h3 id="_8">斐波那契数列与卢卡斯数列的关系<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<p>不难发现，关于卢卡斯数列与斐波那契数列的等式，与三角函数公式具有很高的相似性。比如：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\frac{L_n + F_n\sqrt{5}}{2} = \left(\frac{1 + \sqrt{5}}{2}\right)^n
</div>
<script type="math/tex; mode=display">
\frac{L_n + F_n\sqrt{5}}{2} = \left(\frac{1 + \sqrt{5}}{2}\right)^n
</script>
</div>
<p>与</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\cos nx + i\sin nx = \left(\cos x + i\sin x\right)^n
</div>
<script type="math/tex; mode=display">
\cos nx + i\sin nx = \left(\cos x + i\sin x\right)^n
</script>
</div>
<p>很像。以及</p>
<div class="arithmatex">
<div class="MathJax_Preview">
{L_n}^2-5{F_n}^2=-4
</div>
<script type="math/tex; mode=display">
{L_n}^2-5{F_n}^2=-4
</script>
</div>
<p>与</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\cos^2 x + \sin^2 x = 1
</div>
<script type="math/tex; mode=display">
\cos^2 x + \sin^2 x = 1
</script>
</div>
<p>很像。因此，卢卡斯数列与余弦函数很像，而斐波那契数列与正弦函数很像。比如，根据</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\left(\frac{1 + \sqrt{5}}{2}\right)^m\left(\frac{1 + \sqrt{5}}{2}\right)^n = \left(\frac{1 + \sqrt{5}}{2}\right)^{m+n}
</div>
<script type="math/tex; mode=display">
\left(\frac{1 + \sqrt{5}}{2}\right)^m\left(\frac{1 + \sqrt{5}}{2}\right)^n = \left(\frac{1 + \sqrt{5}}{2}\right)^{m+n}
</script>
</div>
<p>可以得到两下标之和的等式：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
2L_{m+n}=5F_mF_n+L_mL_n
</div>
<script type="math/tex; mode=display">
2L_{m+n}=5F_mF_n+L_mL_n
</script>
</div>
<div class="arithmatex">
<div class="MathJax_Preview">
2F_{m+n}=F_mL_n+L_mF_n
</div>
<script type="math/tex; mode=display">
2F_{m+n}=F_mL_n+L_mF_n
</script>
</div>
<p>于是推论就有二倍下标的等式：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
L_{2n}={L_n}^2-2{\left(-1\right)}^n
</div>
<script type="math/tex; mode=display">
L_{2n}={L_n}^2-2{\left(-1\right)}^n
</script>
</div>
<div class="arithmatex">
<div class="MathJax_Preview">
F_{2n}=F_nL_n
</div>
<script type="math/tex; mode=display">
F_{2n}=F_nL_n
</script>
</div>
<p>这也是一种快速倍增下标的办法。同样地，也可以仿照三角函数的公式，比如奇偶性、和差化积、积化和差、半角、万能代换等等，推理出更多有关卢卡斯数列与斐波那契数列的相应等式。</p>
<h2 id="_9">斐波那契编码<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h2>
<p>我们可以利用斐波那契数列为正整数编码。根据 <a href="https://zh.wikipedia.org/wiki/%E9%BD%8A%E8%82%AF%E5%A4%9A%E5%A4%AB%E5%AE%9A%E7%90%86">齐肯多夫定理</a>，任何自然数 <span class="arithmatex"><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> 可以被唯一地表示成一些斐波那契数的和：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
N = F_{k_1} + F_{k_2} + \ldots + F_{k_r}
</div>
<script type="math/tex; mode=display">
N = F_{k_1} + F_{k_2} + \ldots + F_{k_r}
</script>
</div>
<p>并且 <span class="arithmatex"><span class="MathJax_Preview">k_1 \ge k_2 + 2,\ k_2 \ge k_3 + 2,\  \ldots,\  k_r \ge 2</span><script type="math/tex">k_1 \ge k_2 + 2,\ k_2 \ge k_3 + 2,\  \ldots,\  k_r \ge 2</script></span>（即不能使用两个相邻的斐波那契数）</p>
<p>于是我们可以用 <span class="arithmatex"><span class="MathJax_Preview">d_0 d_1 d_2 \dots d_s 1</span><script type="math/tex">d_0 d_1 d_2 \dots d_s 1</script></span> 的编码表示一个正整数，其中 <span class="arithmatex"><span class="MathJax_Preview">d_i=1</span><script type="math/tex">d_i=1</script></span> 则表示 <span class="arithmatex"><span class="MathJax_Preview">F_{i+2}</span><script type="math/tex">F_{i+2}</script></span> 被使用。编码末位我们强制给它加一个 1（这样会出现两个相邻的 1），表示这一串编码结束。举几个例子：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\begin{aligned}
1 &amp;=&amp; 1 &amp;=&amp; F_2 &amp;=&amp; (11)_F \\
2 &amp;=&amp; 2 &amp;=&amp; F_3 &amp;=&amp; (011)_F \\
6 &amp;=&amp; 5 + 1 &amp;=&amp; F_5 + F_2 &amp;=&amp; (10011)_F \\
8 &amp;=&amp; 8 &amp;=&amp; F_6 &amp;=&amp; (000011)_F \\
9 &amp;=&amp; 8 + 1 &amp;=&amp; F_6 + F_2 &amp;=&amp; (100011)_F \\
19 &amp;=&amp; 13 + 5 + 1 &amp;=&amp; F_7 + F_5 + F_2 &amp;=&amp; (1001011)_F
\end{aligned}
</div>
<script type="math/tex; mode=display">
\begin{aligned}
1 &=& 1 &=& F_2 &=& (11)_F \\
2 &=& 2 &=& F_3 &=& (011)_F \\
6 &=& 5 + 1 &=& F_5 + F_2 &=& (10011)_F \\
8 &=& 8 &=& F_6 &=& (000011)_F \\
9 &=& 8 + 1 &=& F_6 + F_2 &=& (100011)_F \\
19 &=& 13 + 5 + 1 &=& F_7 + F_5 + F_2 &=& (1001011)_F
\end{aligned}
</script>
</div>
<p>给 <span class="arithmatex"><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> 编码的过程可以使用贪心算法解决：</p>
<ol>
<li>从大到小枚举斐波那契数 <span class="arithmatex"><span class="MathJax_Preview">F_i</span><script type="math/tex">F_i</script></span>，直到 <span class="arithmatex"><span class="MathJax_Preview">F_i\le n</span><script type="math/tex">F_i\le n</script></span>。</li>
<li>把 <span class="arithmatex"><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> 减掉 <span class="arithmatex"><span class="MathJax_Preview">F_i</span><script type="math/tex">F_i</script></span>，在编码的 <span class="arithmatex"><span class="MathJax_Preview">i-2</span><script type="math/tex">i-2</script></span> 的位置上放一个 1（编码从左到右以 0 为起点）。</li>
<li>如果 <span class="arithmatex"><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> 为正，回到步骤 1。</li>
<li>最后在编码末位添加一个 1，表示编码的结束位置。</li>
</ol>
<p>解码过程同理，先删掉末位的 1，对于编码为 1 的位置 <span class="arithmatex"><span class="MathJax_Preview">i</span><script type="math/tex">i</script></span>（编码从左到右以 0 为起点），累加一个 <span class="arithmatex"><span class="MathJax_Preview">F_{i+2}</span><script type="math/tex">F_{i+2}</script></span> 到答案。最后的答案就是原数字。</p>
<h2 id="_10">模意义下周期性<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h2>
<p>考虑模 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 意义下的斐波那契数列，可以容易地使用抽屉原理证明，该数列是有周期性的。考虑模意义下前 <span class="arithmatex"><span class="MathJax_Preview">p^2+1</span><script type="math/tex">p^2+1</script></span> 个斐波那契数对（两个相邻数配对）：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
(F_1,\ F_2),\ (F_2,\ F_3),\ \ldots,\ (F_{p^2 + 1},\ F_{p^2 + 2})
</div>
<script type="math/tex; mode=display">
(F_1,\ F_2),\ (F_2,\ F_3),\ \ldots,\ (F_{p^2 + 1},\ F_{p^2 + 2})
</script>
</div>
<p><span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 的剩余系大小为 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span>，意味着在前 <span class="arithmatex"><span class="MathJax_Preview">p^2+1</span><script type="math/tex">p^2+1</script></span> 个数对中必有两个相同的数对，于是这两个数对可以往后生成相同的斐波那契数列，那么他们就是周期性的。</p>
<h3 id="_11">皮萨诺周期<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h3>
<p>模 <span class="arithmatex"><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 意义下斐波那契数列的最小正周期被称为 <a href="https://en.wikipedia.org/wiki/Pisano_period">皮萨诺周期</a>（Pisano periods,<a href="http://oeis.org/A001175">OEIS A001175</a>）。</p>
<p>皮萨诺周期总是不超过 <span class="arithmatex"><span class="MathJax_Preview">6m</span><script type="math/tex">6m</script></span>，且只有在满足 <span class="arithmatex"><span class="MathJax_Preview">m=2\times 5^k</span><script type="math/tex">m=2\times 5^k</script></span> 的形式时才取到等号。</p>
<p>当需要计算第 <span class="arithmatex"><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> 项斐波那契数模 <span class="arithmatex"><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 的值的时候，如果 <span class="arithmatex"><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> 非常大，就需要计算斐波那契数模 <span class="arithmatex"><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 的周期。当然，只需要计算周期，不一定是最小正周期。</p>
<p>容易验证，斐波那契数模 <span class="arithmatex"><span class="MathJax_Preview">2</span><script type="math/tex">2</script></span> 的最小正周期是 <span class="arithmatex"><span class="MathJax_Preview">3</span><script type="math/tex">3</script></span>，模 <span class="arithmatex"><span class="MathJax_Preview">5</span><script type="math/tex">5</script></span> 的最小正周期是 <span class="arithmatex"><span class="MathJax_Preview">20</span><script type="math/tex">20</script></span>。</p>
<p>显然，如果 <span class="arithmatex"><span class="MathJax_Preview">a</span><script type="math/tex">a</script></span> 与 <span class="arithmatex"><span class="MathJax_Preview">b</span><script type="math/tex">b</script></span> 互素，<span class="arithmatex"><span class="MathJax_Preview">ab</span><script type="math/tex">ab</script></span> 的皮萨诺周期就是 <span class="arithmatex"><span class="MathJax_Preview">a</span><script type="math/tex">a</script></span> 的皮萨诺周期与 <span class="arithmatex"><span class="MathJax_Preview">b</span><script type="math/tex">b</script></span> 的皮萨诺周期的最小公倍数。</p>
<p>计算周期还需要以下结论：</p>
<p>结论 1：对于奇素数 <span class="arithmatex"><span class="MathJax_Preview">p\equiv 1,4 \pmod 5</span><script type="math/tex">p\equiv 1,4 \pmod 5</script></span>，<span class="arithmatex"><span class="MathJax_Preview">p-1</span><script type="math/tex">p-1</script></span> 是斐波那契数模 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 的周期。即，奇素数 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 的皮萨诺周期整除 <span class="arithmatex"><span class="MathJax_Preview">p-1</span><script type="math/tex">p-1</script></span>。</p>
<p>证明：</p>
<p>此时 <span class="arithmatex"><span class="MathJax_Preview">5^\frac{p-1}{2} \equiv 1\pmod p</span><script type="math/tex">5^\frac{p-1}{2} \equiv 1\pmod p</script></span>。</p>
<p>由二项式展开：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
F_p=\frac{2}{2^p\sqrt{5}}\left(C_p^1\sqrt{5}+C_p^3\sqrt{5}^3+\ldots+C_p^p\sqrt{5}^p\right)\equiv\sqrt{5}^{p-1}\equiv 1\pmod p
</div>
<script type="math/tex; mode=display">
F_p=\frac{2}{2^p\sqrt{5}}\left(C_p^1\sqrt{5}+C_p^3\sqrt{5}^3+\ldots+C_p^p\sqrt{5}^p\right)\equiv\sqrt{5}^{p-1}\equiv 1\pmod p
</script>
</div>
<div class="arithmatex">
<div class="MathJax_Preview">
F_{p+1}=\frac{2}{2^{p+1}\sqrt{5}}\left(C_{p+1}^1\sqrt{5}+C_{p+1}^3\sqrt{5}^3+\ldots+C_{p+1}^p\sqrt{5}^p\right)\equiv\frac{1}{2}\left(1+\sqrt{5}^{p-1}\right)\equiv 1\pmod p
</div>
<script type="math/tex; mode=display">
F_{p+1}=\frac{2}{2^{p+1}\sqrt{5}}\left(C_{p+1}^1\sqrt{5}+C_{p+1}^3\sqrt{5}^3+\ldots+C_{p+1}^p\sqrt{5}^p\right)\equiv\frac{1}{2}\left(1+\sqrt{5}^{p-1}\right)\equiv 1\pmod p
</script>
</div>
<p>因为 <span class="arithmatex"><span class="MathJax_Preview">F_p</span><script type="math/tex">F_p</script></span> 和 <span class="arithmatex"><span class="MathJax_Preview">F_{p+1}</span><script type="math/tex">F_{p+1}</script></span> 两项都同余于 <span class="arithmatex"><span class="MathJax_Preview">1</span><script type="math/tex">1</script></span>，与 <span class="arithmatex"><span class="MathJax_Preview">F_1</span><script type="math/tex">F_1</script></span> 和 <span class="arithmatex"><span class="MathJax_Preview">F_2</span><script type="math/tex">F_2</script></span> 一致，所以 <span class="arithmatex"><span class="MathJax_Preview">p-1</span><script type="math/tex">p-1</script></span> 是周期。</p>
<p>结论 2：对于奇素数 <span class="arithmatex"><span class="MathJax_Preview">p\equiv 2,3 \pmod 5</span><script type="math/tex">p\equiv 2,3 \pmod 5</script></span>，<span class="arithmatex"><span class="MathJax_Preview">2p+2</span><script type="math/tex">2p+2</script></span> 是斐波那契数模 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 的周期。即，奇素数 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 的皮萨诺周期整除 <span class="arithmatex"><span class="MathJax_Preview">2p+2</span><script type="math/tex">2p+2</script></span>。</p>
<p>证明：</p>
<p>此时 <span class="arithmatex"><span class="MathJax_Preview">5^\frac{p-1}{2} \equiv -1\pmod p</span><script type="math/tex">5^\frac{p-1}{2} \equiv -1\pmod p</script></span>。</p>
<p>由二项式展开：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
F_{2p}=\frac{2}{2^{2p}\sqrt{5}}\left(C_{2p}^1\sqrt{5}+C_{2p}^3\sqrt{5}^3+\ldots+C_{2p}^{2p-1}\sqrt{5}^{2p-1}\right)
</div>
<script type="math/tex; mode=display">
F_{2p}=\frac{2}{2^{2p}\sqrt{5}}\left(C_{2p}^1\sqrt{5}+C_{2p}^3\sqrt{5}^3+\ldots+C_{2p}^{2p-1}\sqrt{5}^{2p-1}\right)
</script>
</div>
<div class="arithmatex">
<div class="MathJax_Preview">
F_{2p+1}=\frac{2}{2^{2p+1}\sqrt{5}}\left(C_{2p+1}^1\sqrt{5}+C_{2p+1}^3\sqrt{5}^3+\ldots+C_{2p+1}^{2p+1}\sqrt{5}^{2p+1}\right)
</div>
<script type="math/tex; mode=display">
F_{2p+1}=\frac{2}{2^{2p+1}\sqrt{5}}\left(C_{2p+1}^1\sqrt{5}+C_{2p+1}^3\sqrt{5}^3+\ldots+C_{2p+1}^{2p+1}\sqrt{5}^{2p+1}\right)
</script>
</div>
<p>模 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 之后，在 <span class="arithmatex"><span class="MathJax_Preview">F_{2p}</span><script type="math/tex">F_{2p}</script></span> 式中，只有 <span class="arithmatex"><span class="MathJax_Preview">C_{2p}^p\equiv 2 \pmod p</span><script type="math/tex">C_{2p}^p\equiv 2 \pmod p</script></span> 项留了下来；在 <span class="arithmatex"><span class="MathJax_Preview">F_{2p+1}</span><script type="math/tex">F_{2p+1}</script></span> 式中，有 <span class="arithmatex"><span class="MathJax_Preview">C_{2p+1}^1\equiv 1 \pmod p</span><script type="math/tex">C_{2p+1}^1\equiv 1 \pmod p</script></span>、<span class="arithmatex"><span class="MathJax_Preview">C_{2p+1}^p\equiv 2 \pmod p</span><script type="math/tex">C_{2p+1}^p\equiv 2 \pmod p</script></span>、<span class="arithmatex"><span class="MathJax_Preview">C_{2p+1}^{2p+1}\equiv 1 \pmod p</span><script type="math/tex">C_{2p+1}^{2p+1}\equiv 1 \pmod p</script></span>，三项留了下来。</p>
<div class="arithmatex">
<div class="MathJax_Preview">
F_{2p}\equiv\frac{1}{2}C_{2p}^p\sqrt{5}^{p-1}\equiv -1 \pmod p
</div>
<script type="math/tex; mode=display">
F_{2p}\equiv\frac{1}{2}C_{2p}^p\sqrt{5}^{p-1}\equiv -1 \pmod p
</script>
</div>
<div class="arithmatex">
<div class="MathJax_Preview">
F_{2p+1}\equiv\frac{1}{4}\left(C_{2p+1}^1+C_{2p+1}^p\sqrt{5}^{p-1}+C_{2p+1}^{2p+1}\sqrt{5}^{2p}\right)\equiv\frac{1}{4}\left(1-2+5\right)\equiv 1 \pmod p
</div>
<script type="math/tex; mode=display">
F_{2p+1}\equiv\frac{1}{4}\left(C_{2p+1}^1+C_{2p+1}^p\sqrt{5}^{p-1}+C_{2p+1}^{2p+1}\sqrt{5}^{2p}\right)\equiv\frac{1}{4}\left(1-2+5\right)\equiv 1 \pmod p
</script>
</div>
<p>于是 <span class="arithmatex"><span class="MathJax_Preview">F_{2p}</span><script type="math/tex">F_{2p}</script></span> 和 <span class="arithmatex"><span class="MathJax_Preview">F_{2p+1}</span><script type="math/tex">F_{2p+1}</script></span> 两项与 <span class="arithmatex"><span class="MathJax_Preview">F_{-2}</span><script type="math/tex">F_{-2}</script></span> 和 <span class="arithmatex"><span class="MathJax_Preview">F_{-1}</span><script type="math/tex">F_{-1}</script></span> 一致，所以 <span class="arithmatex"><span class="MathJax_Preview">2p+2</span><script type="math/tex">2p+2</script></span> 是周期。</p>
<p>结论 3：对于素数 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span>，<span class="arithmatex"><span class="MathJax_Preview">M</span><script type="math/tex">M</script></span> 是斐波那契数模 <span class="arithmatex"><span class="MathJax_Preview">p^{k-1}</span><script type="math/tex">p^{k-1}</script></span> 的周期，等价于 <span class="arithmatex"><span class="MathJax_Preview">Mp</span><script type="math/tex">Mp</script></span> 是斐波那契数模 <span class="arithmatex"><span class="MathJax_Preview">p^k</span><script type="math/tex">p^k</script></span> 的周期。特别地，<span class="arithmatex"><span class="MathJax_Preview">M</span><script type="math/tex">M</script></span> 是模 <span class="arithmatex"><span class="MathJax_Preview">p^{k-1}</span><script type="math/tex">p^{k-1}</script></span> 的皮萨诺周期，等价于 <span class="arithmatex"><span class="MathJax_Preview">Mp</span><script type="math/tex">Mp</script></span> 是模 <span class="arithmatex"><span class="MathJax_Preview">p^k</span><script type="math/tex">p^k</script></span> 的皮萨诺周期。</p>
<p>证明：</p>
<p>这里的证明需要把 <span class="arithmatex"><span class="MathJax_Preview">\frac{1+\sqrt{5}}{2}</span><script type="math/tex">\frac{1+\sqrt{5}}{2}</script></span> 看作一个整体。</p>
<p>由于：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
F_M=\frac{1}{\sqrt{5}}\left(\left(\frac{1+\sqrt{5}}{2}\right)^M-\left(\frac{1-\sqrt{5}}{2}\right)^M\right)\equiv 0\pmod {p^{k-1}}
</div>
<script type="math/tex; mode=display">
F_M=\frac{1}{\sqrt{5}}\left(\left(\frac{1+\sqrt{5}}{2}\right)^M-\left(\frac{1-\sqrt{5}}{2}\right)^M\right)\equiv 0\pmod {p^{k-1}}
</script>
</div>
<div class="arithmatex">
<div class="MathJax_Preview">
F_{M+1}=\frac{1}{\sqrt{5}}\left(\left(\frac{1+\sqrt{5}}{2}\right)^{M+1}-\left(\frac{1-\sqrt{5}}{2}\right)^{M+1}\right)\equiv 1\pmod {p^{k-1}}
</div>
<script type="math/tex; mode=display">
F_{M+1}=\frac{1}{\sqrt{5}}\left(\left(\frac{1+\sqrt{5}}{2}\right)^{M+1}-\left(\frac{1-\sqrt{5}}{2}\right)^{M+1}\right)\equiv 1\pmod {p^{k-1}}
</script>
</div>
<p>因此：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\left(\frac{1+\sqrt{5}}{2}\right)^M \equiv \left(\frac{1-\sqrt{5}}{2}\right)^M\pmod {p^{k-1}}
</div>
<script type="math/tex; mode=display">
\left(\frac{1+\sqrt{5}}{2}\right)^M \equiv \left(\frac{1-\sqrt{5}}{2}\right)^M\pmod {p^{k-1}}
</script>
</div>
<div class="arithmatex">
<div class="MathJax_Preview">
1\equiv\frac{1}{\sqrt{5}}\left(\frac{1+\sqrt{5}}{2}\right)^M\left(\left(\frac{1+\sqrt{5}}{2}\right)-\left(\frac{1-\sqrt{5}}{2}\right)\right)=\left(\frac{1+\sqrt{5}}{2}\right)^M\pmod {p^{k-1}}
</div>
<script type="math/tex; mode=display">
1\equiv\frac{1}{\sqrt{5}}\left(\frac{1+\sqrt{5}}{2}\right)^M\left(\left(\frac{1+\sqrt{5}}{2}\right)-\left(\frac{1-\sqrt{5}}{2}\right)\right)=\left(\frac{1+\sqrt{5}}{2}\right)^M\pmod {p^{k-1}}
</script>
</div>
<p>因为反方向也可以推导，所以 <span class="arithmatex"><span class="MathJax_Preview">M</span><script type="math/tex">M</script></span> 是斐波那契数模 <span class="arithmatex"><span class="MathJax_Preview">p^{k-1}</span><script type="math/tex">p^{k-1}</script></span> 的周期，等价于：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\left(\frac{1+\sqrt{5}}{2}\right)^M \equiv \left(\frac{1-\sqrt{5}}{2}\right)^M\equiv 1\pmod {p^{k-1}}
</div>
<script type="math/tex; mode=display">
\left(\frac{1+\sqrt{5}}{2}\right)^M \equiv \left(\frac{1-\sqrt{5}}{2}\right)^M\equiv 1\pmod {p^{k-1}}
</script>
</div>
<p>当 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 是奇素数时，根据模奇素数 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 的升幂定理，有：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
v_p\left(a^t-1\right)=v_p\left(a-1\right)+v_p(t)
</div>
<script type="math/tex; mode=display">
v_p\left(a^t-1\right)=v_p\left(a-1\right)+v_p(t)
</script>
</div>
<p>当 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 是 <span class="arithmatex"><span class="MathJax_Preview">2</span><script type="math/tex">2</script></span> 时，根据模 <span class="arithmatex"><span class="MathJax_Preview">2</span><script type="math/tex">2</script></span> 的升幂定理，有：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
v_2\left(a^t-1\right)=v_2\left(a-1\right)+v_2\left(a+1\right)+v_2(t)-1
</div>
<script type="math/tex; mode=display">
v_2\left(a^t-1\right)=v_2\left(a-1\right)+v_2\left(a+1\right)+v_2(t)-1
</script>
</div>
<p>代入 <span class="arithmatex"><span class="MathJax_Preview">a</span><script type="math/tex">a</script></span> 为 <span class="arithmatex"><span class="MathJax_Preview">\left(\frac{1+\sqrt{5}}{2}\right)</span><script type="math/tex">\left(\frac{1+\sqrt{5}}{2}\right)</script></span> 和 <span class="arithmatex"><span class="MathJax_Preview">\left(\frac{1-\sqrt{5}}{2}\right)</span><script type="math/tex">\left(\frac{1-\sqrt{5}}{2}\right)</script></span>，<span class="arithmatex"><span class="MathJax_Preview">t</span><script type="math/tex">t</script></span> 为 <span class="arithmatex"><span class="MathJax_Preview">M</span><script type="math/tex">M</script></span> 和 <span class="arithmatex"><span class="MathJax_Preview">Mp</span><script type="math/tex">Mp</script></span>，上述条件也就等价于：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\left(\frac{1+\sqrt{5}}{2}\right)^{Mp} \equiv \left(\frac{1-\sqrt{5}}{2}\right)^{Mp}\equiv 1\pmod {p^k}
</div>
<script type="math/tex; mode=display">
\left(\frac{1+\sqrt{5}}{2}\right)^{Mp} \equiv \left(\frac{1-\sqrt{5}}{2}\right)^{Mp}\equiv 1\pmod {p^k}
</script>
</div>
<p>因此也等价于 <span class="arithmatex"><span class="MathJax_Preview">Mp</span><script type="math/tex">Mp</script></span> 是斐波那契数模 <span class="arithmatex"><span class="MathJax_Preview">p^k</span><script type="math/tex">p^k</script></span> 的周期。</p>
<p>因为周期等价，所以最小正周期也等价。</p>
<p>三个结论证完。据此可以写出代码：</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">struct</span><span class="w"> </span><span class="nc">prime</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">p</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">times</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">struct</span><span class="w"> </span><span class="nc">prime</span><span class="w"> </span><span class="n">pp</span><span class="p">[</span><span class="mi">2048</span><span class="p">];</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="n">pptop</span><span class="p">;</span><span class="w"></span>

<span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="nf">get_cycle_from_mod</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">mod</span><span class="p">)</span><span class="w">  </span><span class="c1">// 这里求解的只是周期，不一定是最小正周期</span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="n">pptop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="n">srand</span><span class="p">(</span><span class="n">time</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span><span class="w"></span>
<span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">__int128_t</span><span class="w"> </span><span class="n">factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">__int128_t</span><span class="p">)</span><span class="mi">10000000000</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">10000000000</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">min_factor</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">factor</span><span class="p">);</span><span class="w">  </span><span class="c1">// 计算最小素因数</span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">prime</span><span class="w"> </span><span class="n">temp</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">temp</span><span class="p">.</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">factor</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">temp</span><span class="p">.</span><span class="n">times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">mod</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">factor</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">times</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">mod</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">factor</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">pp</span><span class="p">[</span><span class="n">pptop</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">pptop</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">pptop</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">g</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pp</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">p</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pp</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">p</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pp</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">p</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">pp</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">p</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pp</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">p</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">pp</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">p</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lcm</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">g</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">qpow</span><span class="p">(</span><span class="n">pp</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">pp</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">times</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div></td></tr></table></div>
<h2 id="_12">习题<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="http://www.spoj.com/problems/MAIN74/">SPOJ - Euclid Algorithm Revisited</a></li>
<li><a href="http://www.spoj.com/problems/FIBOSUM/">SPOJ - Fibonacci Sum</a></li>
<li><a href="https://www.hackerrank.com/contests/codesprint5/challenges/is-fibo/problem">HackerRank - Is Fibo</a></li>
<li><a href="https://www.hackerrank.com/contests/projecteuler/challenges/euler002/problem">Project Euler - Even Fibonacci numbers</a></li>
<li>
<p><a href="https://www.luogu.com.cn/problem/P4000">洛谷 P4000 斐波那契数列</a></p>
<p><strong>本页面主要译自博文 <a href="http://e-maxx.ru/algo/fibonacci_numbers">Числа Фибоначчи</a> 与其英文翻译版 <a href="https://cp-algorithms.com/algebra/fibonacci-numbers.html">Fibonacci Numbers</a>。其中俄文版版权协议为 Public Domain + Leave a Link；英文版版权协议为 CC-BY-SA 4.0。</strong></p>
</li>
</ul>
                
                  
                
              
              
                 
 
 
<hr><blockquote class="page-copyright">
  <span><i class="md-icon">build</i>本页面最近更新：</span><span class="facts_modified"></span>，<a class="edit_history">更新历史</a><br>
  <span><i class="md-icon">edit</i>发现错误？想一起完善？ <a href="https://github.com/WWeiying/Learn-notes/edit/master/docs/math/fibonacci.md" title="编辑此页" class="page_edit_url">在 GitHub 上编辑此页！</a></span><br>
  <span><i class="md-icon">people</i>本页面贡献者：</span><span class="page_contributors">OI-wiki</span><br>
  <span><i class="md-icon">copyright</i>本页面的全部内容在 <strong><a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh">CC BY-SA 4.0</a> 和 <a href="https://github.com/zTrix/sata-license">SATA</a></strong> 协议之条款下提供，附加条款亦可能应用</span>
</blockquote>


<h2 id="__comments" data-no-instant>评论</h2>
<form id="gitalk-form" onsubmit="return!1" data-no-instant>
<div id="gitalk-container" data-no-instant>
</div>
</form>
<link rel="stylesheet" href="../../assets/vendor/gitalk/gitalk.css">
<script src="../../assets/vendor/gitalk/gitalk.min.js"></script>
<script>
  const gitalk = new Gitalk({
    id: 'Fibonacci',
    owner: 'WWeiying',
    repo: 'WWeiying',
    admin: ['WWeiying'],
    clientID: 'd3dc000b2047f49b2bd8',
    clientSecret: 'b20c67ecf9762b0de64976355994ac758d506962',
    distractionFreeMode: false,
    pagerDirection: 'first'
  })
  gitalk.render('gitalk-container')
</script>

              
            </article>
          </div>
        </div>
      </main>
      
        
<script>function scrollFunction(){20<document.body.scrollTop||20<document.documentElement.scrollTop?document.getElementById("myBtn").style.display="block":document.getElementById("myBtn").style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}window.onscroll=function(){scrollFunction()}</script>
<button onclick="topFunction()" id="myBtn" class="data-tip-left" data-tip="回到顶部">
  <svg class="Zi Zi--BackToTop data-tip-left" data-tip="回到顶部" fill="currentColor" viewBox="0 0 24 24" width="24" height="24">
    <path d="M16.036 19.59a1 1 0 0 1-.997.995H9.032a.996.996 0 0 1-.997-.996v-7.005H5.03c-1.1 0-1.36-.633-.578-1.416L11.33 4.29a1.003 1.003 0 0 1 1.412 0l6.878 6.88c.782.78.523 1.415-.58 1.415h-3.004v7.005z"></path>
  </svg>
</button>
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2022 WWeiying
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
        <div id="miitbeian"></div>
      </div>
      
      <span style="float:right" class="build_date_utc"><a href="https://github.com/24OI/OI-wiki">最近更新：, 2022-04-29</a></span>
      <script>
        /* miitbeian */
        if (window.location.hostname == "oi-wiki.com") {
          document.getElementById("miitbeian").innerHTML = `<a href="http://beian.miit.gov.cn/">黑ICP备19005132号-2</a>`;
        }
        /* Easter Egg */
        console.log(`%c OI Wiki %c  %c`,"background:#35495e ; padding: 1px; border-radius: 3px 0 0 3px;  color: #fff","background:#41b883 ; padding: 1px; border-radius: 0 3px 3px 0;  color: #fff","background:transparent");
        console.log('少年，恭喜你囍提彩蛋，我们在做一些 OI 相关的有趣的事情，如果您对此感兴趣，欢迎访问 https://join-us.oi-wiki.org');
      </script>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.411a9f9f.js"></script>
      <script>app.initialize({version:"1.2.4",url:{base:"../.."}}),"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js",{scope:"/"}).then(function(e){console.log("PWA Registration succeeded. Scope is "+e.scope)}).catch(function(e){console.log("PWA Registration failed with "+e)})</script>
      
        <script src="../../_static/js/extra.js?v=16"></script>
      
        <script src="../../assets/vendor/mathjax/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>